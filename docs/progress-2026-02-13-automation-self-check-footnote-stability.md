# 2026-02-13 自动化自检与修复记录（注脚稳定性）

## 目标
对当前编辑器进行自动化自检，定位“注脚插入/编辑异常、样式异常、可能的交互回退”相关问题。

## 自检方式
- 使用 Playwright 打开 `http://localhost:5173`
- 执行键盘链路：`Ctrl+End` -> `Enter` -> `Ctrl+Shift+F`
- 验证点：
  - 插入注脚不弹窗
  - 光标/选区落在 `[^x]` 的 `x` 上
  - 注脚定义行保留回跳按钮（无引用时禁用态）
  - 控制台无报错

## 发现问题
- 注脚 key 编辑时会发生字符异常（`[^2]` 可能被错误渲染为 `[²]`），导致注脚语法识别中断。

## 修复内容
- 文件：`src/lib/components/HybricEditor.tsx`
- 操作：移除 `@tiptap/extension-typography` 扩展接入，避免对 `[^x]` 语法 token 的输入干扰。

## 回归结果
- `Ctrl+Shift+F` 插入后显示 `[^2]:` 正常
- `x` 选区回填正常
- 无注脚插入弹窗
- Playwright 控制台错误：无
- 本地校验：
  - `npm run lint` 通过
  - `npm run build` 通过

## 备注
本次仅修复注脚 token 输入稳定性，不改动其他业务逻辑。
